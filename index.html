<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Login Form</title>
    <link rel="stylesheet" href="login_style2.css">
  </head>
  <body>
    <div class="wrapper">
      <div class="title">Login Form</div>
      <form action="#">
        <div class="field">
          <input type="text" required="" name="username" id="username" class="form-control" placeholder="Username">
          <label>Username</label>
        </div>
        <div class="field">
          <input type="password" required="" name="password" id="password" class="form-control" placeholder="Username">
          <label>Password</label>
        </div>
        
        <div class="field">          
          <input type="submit" name="ok" class="btn btn-sm btn-success" value="Login">
        </div>
        <div class="signup-link">Not a member? <a href="register.html">Signup now</a></div>
      </form>
    </div>


    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>


<script type="text/javascript">
  const url = "http://tweetapi.server/";
  $(document).ready(function(){
    $("#login-form").on("submit",function(e){
      e.preventDefault();

      let username = $("#username").val();
      let password = $("#password").val();

      $.ajax({
        url: url + "login",
        xhrFields: {
            //withCredentials: true,
            credentials: 'same-origin',
          },
        data: {
          'username': username,
          'password': password
        },
        dataType: 'json',
        method: 'post',
        success: function(f){
          //console.log(f);
          alert(f.status.msg);
          if(f.status.type == "success"){
            sessionStorage.setItem("user_id", f.user_data.id);
            window.location = "home.html";
          }
        },
        error: function(e){
          //console.log(e);
        }
      });
    });
  });
</script>

  </body>
</html>
